---
layout: post
title: Webhook без веб сервера
date: '2021-03-08 10:37:00'
tags:
- programming
---

Если развернуть веб сервер с вебхуком возможности нет, а принимать сообщения от какого-то сервиса (например Telegram) нужно, мы используем polling. Это когда мы сами спрашиваем у сервиса, нет ли у него для нас новостей. В случае с Telegram, это происходит через запрос [getUpdates](https://core.telegram.org/bots/api#getupdates).

Но что, если сервис не имеет своего поллинг сервера и предлагает лишь доставку апдейтов на webhook, как например GitHub? Или есть ряд других проблем, которые перечислены в разделе "Применения"?

# Решение

poll.gmod.app — микросервис, который может выступить в качестве вебхука, а сам отдавать обновления по запросу (по подобию getUpdates у телеграм)

Там где вам нужно указать ссылку на вебхук, вы указываете ссылку на наш микросервис. Мы принимаем входящие сообщения, храним их у себя, а вы потом получаете их через http GET запрос

## Документация
<figure class="kg-card kg-bookmark-card"><a class="kg-bookmark-container" href=" __GHOST_URL__ /poll-gmod-app-docs/"><div class="kg-bookmark-content">
<div class="kg-bookmark-title">poll.gmod.app документация</div>
<div class="kg-bookmark-description">Это простейший Long Polling микросервис, который выступает в качестве своеобразного WebHook сервера для POST запросов. Принятые данные можно получить с сервера по GET запросу. Рассчитан для ограниченной среды, где усложнена или отсутствует возможность поднятия Web сервера для своих вебхуков.Рекоменд…</div>
<div class="kg-bookmark-metadata">
<span class="kg-bookmark-author">Блог _AMD_</span><span class="kg-bookmark-publisher">_AMD_</span>
</div>
</div>
<div class="kg-bookmark-thumbnail"><img src="https://s3.blog.amd-nick.me/2021/11/poll-gmod-app-docs.jpg" alt=""></div></a></figure>
## Применения

> Главная цель – сделать единую точку, куда все сервисы будут присылать апдейты, а клиенты забирать все сразу с одного единственного места. **Проще выполнить один GET запрос вместо 20 разных**.

Изначальное применение найдено в Garry's Mod. Это игра, где разработчики имеют условно полную свободу действий на своих серверах, но поднять веб-сервер является проблемой.

- [gm-donate](https://gm-donate.ru) – сервис приема пожертвований для Garry's Mod серверов [использует](https://github.com/GM-DONATE/IGS/tree/main/addons/igs-core/lua/igs/modules/pushes) poll.gmod.app как способ мгновенной доставки сообщений о платежах Garry's Mod серверам для мгновенного зачисления
- [ggram](https://git.io/ggram) – библиотека для создания Telegram ботов на Garry's Mod серверах может использовать и poll.gmod.app как единую точку, куда множество Telegram ботов присылают апдейты.
- [Integromat](http://integromat.com) – nocode сервис для автоматизации всего и вся присылает отчеты на poll.gmod.app, которые в дальнейшем обрабатываются кодом на Garry's Mod сервере
- [Monobank API](https://api.monobank.ua/docs/) – украинский мобильный банк, присылает на единственный URL poll.gmod.app пуши сразу с десятка аккаунтов, когда по карте проходит какая-то транзакция, а специальный Telegram бот отправляет информацию о транзакции в чат
- GitHub присылает сообщения с коммитами с нескольких репозиториев сразу, а специальный бот делает [красивый summary](https://img.qweqwe.ovh/1636912086234.png) в специальном чате

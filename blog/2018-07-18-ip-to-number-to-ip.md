---
title: ip to int –∏ int to ip –Ω–∞ –ø–∞–ª—å—Ü–∞—Ö
date: '2018-07-18 13:31:00'
slug: ip-to-number-to-ip
tags: [lua, dev]
---

## UPD 2023.12.15 üëã

**–ó–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è 2023 –≥–æ–¥, –∞ —Å—Ç–∞—Ç—å—è –¥–æ —Å–∏—Ö –ø–æ—Ä —Ö–æ—Ä–æ—à–∞—è**. –≠—Ç–∞ —Ç–µ–º–∞ –¥–æ —Å–∏—Ö –ø–æ—Ä –Ω–∞—Ö–æ–¥–∏—Ç –æ—Ç–≥–æ–ª–æ—Å–∫–∏ –≤ –º–æ–∏—Ö —Ç–µ–∫—É—â–∏—Ö –∑–∞–¥–∞—á–∞—Ö. –ò–º–µ–Ω–Ω–æ –∏–∑—É—á–µ–Ω–∏–µ —Ç–æ–≥–æ, –∫–∞–∫ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è ip —Ç–æ–ª–∫–Ω—É–ª–æ –º–µ–Ω—è –≤ –ø–æ–Ω–∏–º–∞–Ω–∏–∏ –ø–æ–±–∏—Ç–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π, –∞ —Ç–∞–∫–∂–µ —Å–µ—Ç–µ–≤—ã—Ö –º–∞—Å–æ–∫.

---

–ú–Ω–µ –ø–æ—Ç—Ä–µ–±–æ–≤–∞–ª–∞—Å—å —Ñ—É–Ω–∫—Ü–∏—è, –æ–ø—Ä–µ–¥–µ–ª—è—é—â–∞—è, –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ª–∏ IP –ø–æ–¥ —É–∫–∞–∑–∞–Ω–Ω–æ–π –º–∞—Å–∫–æ–π –∏ —è –∑–∞—Ö–æ—Ç–µ–ª –≤ –¥–µ—Ç–∞–ª—è—Ö –ø–æ–Ω—è—Ç—å, –∫–∞–∫ –æ–Ω–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç. –î–ª—è —ç—Ç–æ–≥–æ –Ω–∞–¥–æ –±—ã–ª–æ –ø–æ–Ω—è—Ç—å, –∫–∞–∫ IP –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –≤ —Ü–µ–ª—ã–µ —á–∏—Å–ª–∞ –∏ –Ω–∞–æ–±–æ—Ä–æ—Ç

–ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è IP –≤ —á–∏—Å–ª–æ –∏ –æ–±—Ä–∞—Ç–Ω–æ —ç—Ç–æ –ø–æ–±–∏—Ç–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏, –Ω–æ —è –ø–æ—Å—Ç–∞—Ä–∞—é—Å—å –æ–±—ä—è—Å–Ω–∏—Ç—å –≤—Å–µ —Ç–∞–∫, —á—Ç–æ–±—ã –ø–æ–Ω—è—Ç–Ω–æ –±—ã–ª–æ —Ç–µ–º, –∫—Ç–æ —Å –Ω–∏–º–∏ –Ω–µ –∑–Ω–∞–∫–æ–º –∏–ª–∏ –ø–ª–æ—Ö–æ –∑–Ω–∞–∫–æ–º. –ü–æ–¥—Ä–æ–±–Ω–µ–µ –æ –Ω–∏—Ö –º–æ–∂–Ω–æ –ø–æ—á–∏—Ç–∞—Ç—å, [–Ω–∞–ø—Ä–∏–º–µ—Ä, –∑–¥–µ—Å—å](http://php.net/manual/ru/language.operators.bitwise.php).

## –ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ IP

–ö–∞–∫ –≤–∞–º –∏–∑–≤–µ—Å—Ç–Ω–æ, IP —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ 4 –±–ª–æ–∫–æ–≤, –≥–¥–µ —á–∏—Å–ª–æ –≤ –±–ª–æ–∫–µ \<= 255. –ü–æ—á–µ–º—É? –í —Å—Ç–∞—Ä—ã–µ –≤—Ä–µ–º–µ–Ω–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä—ã –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–ª–∏ —á–∏—Å–ª–∞ —Ç–æ–ª—å–∫–æ –¥–æ 32 –±–∏—Ç. –í 32 –±–∏—Ç–∞—Ö –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ —á–∏—Å–ª–æ `2^32-1 = 4294967295`. –í —à–µ—Å—Ç–Ω–∞–¥—Ü–∞—Ç–∏—Ä–∏—á–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ (HEX) –æ–Ω–æ –≤—ã–≥–ª—è–¥–∏—Ç –∫–∞–∫ FFFFFFFF –∏–ª–∏ 32 –Ω–æ–ª—è –≤ –¥–≤–æ–∏—á–Ω–æ–π (BIN).

–ê —Ç–µ–ø–µ—Ä—å —Ä–∞–∑–¥–µ–ª–∏–º FFFFFFFF –Ω–∞ 4 –∫—É—Å–æ—á–∫–∞ (–±–ª–æ–∫–∞): FF FF FF FF
`FF HEX = 255 DEC`. –û—Ç—Å—é–¥–∞ –∏ –ø–æ–ª—É—á–∞–µ—Ç—Å—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –±–æ–ª—å—à–æ–π –ò–ü: 255.255.255.255.

> IP —ç—Ç–æ HEX –∏–ª–∏ BIN –∫—É—Å–æ—á–∫–∏, —Ä–∞–∑–¥–µ–ª–µ–Ω–Ω—ã–µ —Ç–æ—á–∫–æ–π

–í–∏–¥ 255.255.255.255 –≤ —Ä–∞–∑–Ω—ã—Ö –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è—Ö:

    DEC 255 255 255 255
    BIN 11111111 11111111 11111111 11111111
    HEX FF FF FF FF

> –ù–æ–ª–∏ –≤ –Ω–∞—á–∞–ª–µ —á–∏—Å–µ–ª –Ω–∏—á–µ–≥–æ –Ω–µ –∑–Ω–∞—á–∞—Ç. –¢–æ–µ—Å—Ç—å, 000001 == 1, –ø–æ—ç—Ç–æ–º—É –µ—Å–ª–∏ –≤ —Ç–µ–∫—Å—Ç–µ –Ω–∏–∂–µ —Å–Ω–∞—á–∞–ª–∞ —á–∏—Å–µ–ª –±—É–¥—É—Ç –Ω–æ–ª–∏, —Ç–æ –æ–Ω–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã "–¥–ª—è –∫—Ä–∞—Å–æ—Ç—ã"

–ï—â–µ –ø—Ä–∏–º–µ—Ä. –í–æ–∑—å–º–µ–º –ª—é–±–æ–π –¥—Ä—É–≥–æ–π –ò–ü, –Ω–∞–ø—Ä–∏–º–µ—Ä **37.230.210.51**. –†–∞–∑–¥–µ–ª–∏–º –µ–≥–æ –Ω–∞ –∫—É—Å–æ—á–∫–∏: 37 230 210 51. –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –∫–∞–∂–¥—ã–π –∏–∑ —ç—Ç–∏—Ö –∫—É—Å–æ—á–∫–æ–≤ –≤ HEX –∏ BIN:

    DEC 037 230 210 051
    BIN 00100101 11100110 11010010 00110011
    HEX 25 E6 D2 33

> –ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä –¥–µ—Å—è—Ç–∏—á–Ω—ã—Ö —á–∏—Å–ª–µ–ª –≤ –¥–≤–æ–∏—á–Ω—ã–µ –∏ HEX [–∑–¥–µ—Å—å](https://www.rapidtables.com/convert/number/decimal-to-binary.html)

–°–∫–ª–µ–∏–≤–∞–µ–º, –ø–æ–ª—É—á–∞–µ—Ç—Å—è `HEX 25E6D233` –∏–ª–∏ `BIN 00100101 11100110 11010010 00110011`. –¢–µ–ø–µ—Ä—å –º–æ–∂–µ—Ç–µ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–æ –≤ DEC –∏ –ø–æ–ª—É—á–∏—Ç–µ IP –≤ –≤–∏–¥–µ —á–∏—Å–ª–∞, –∫–æ—Ç–æ—Ä—ã–º –µ–≥–æ —É–¥–æ–±–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å –≤ –ë–î

## –§—É–Ω–∫—Ü–∏—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ IP –≤ —á–∏—Å–ª–æ

```lua
local function ipToInt(ip) -- ip = 37.230.210.51
	local int = 0

	-- 31 230 210 51
	local p1, p2, p3, p4 = ip:match("(%d+)%.(%d+)%.(%d+)%.(%d+)")

	-- BIN | HEX
	int = int + bit.lshift(p1,24) -- 00100101 00000000 00000000 00000000 | 25 00 00 00
	int = int + bit.lshift(p2,16) -- 00100101 11100110 00000000 00000000 | 25 E6 00 00
	int = int + bit.lshift(p3,8) -- 00100101 11100110 11010010 00000000 | 25 E6 D2 00
	int = int + p4 -- 00100101 11100110 11010010 00110011 | 25 E6 D2 33

	return int -- 635884083
end
```

–§—É–Ω–∫—Ü–∏—è `bit.lshift(a, b)` —Å–º–µ—â–∞–µ—Ç —á–∏—Å–ª–æ `a` –Ω–∞ `b` –±–∏—Ç –≤–ª–µ–≤–æ (–î–æ–±–∞–≤–ª—è—è –Ω–æ–ª–∏ —Å–ø—Ä–∞–≤–∞).
–¢–æ–µ—Å—Ç—å `11010111` –ø–æ—Å–ª–µ —Å–º–µ—â–µ–Ω–∏—è –Ω–∞ 3 –±–∏—Ç–∞ –≤–ª–µ–≤–æ –ø—Ä–µ–≤—Ä–∞—Ç–∏—Ç—Å—è –≤ `11010111000`. –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ —Å–º–µ—â–µ–Ω–∏–µ –Ω–∞ 3 –±–∏—Ç–∞ –≤–ø—Ä–∞–≤–æ –≤–µ—Ä–Ω–µ—Ç —á–∏—Å–ª–æ –≤ –ø—Ä–µ–∂–Ω–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ, —É–±—Ä–∞–≤ –Ω–æ–ª–∏ —Å–ø—Ä–∞–≤–∞

–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ —Ñ—É–Ω–∫—Ü–∏–∏? –û–Ω–∞ –ø–æ–º–µ—â–∞–µ—Ç –∫–∞–∂–¥—ã–π –∫—É—Å–æ—á–µ–∫ IP –Ω–∞ —Å–≤–æ–µ –º–µ—Å—Ç–æ –≤ –±–∏—Ç–æ–≤–æ–º –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–∏ –∏ –Ω–∞ –≤—ã—Ö–ª–æ–ø–µ –ø–æ–ª—É—á–∞–µ—Ç—Å—è –Ω—É–∂–Ω–æ–µ —á–∏—Å–ª–æ. –§—É–Ω–∫—Ü–∏—è –¥–µ–ª–∞–µ—Ç —Ç–æ –∂–µ —Å–∞–º–æ–µ, —á—Ç–æ –±—ã–ª–æ –æ–ø–∏—Å–∞–Ω–æ —Ä–∞–Ω–µ–µ, —Ç–æ–ª—å–∫–æ –∑–∞ —Å—á–µ—Ç –º–∞—Ç–µ–º–∞—Ç–∏–∫–∏

## –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —á–∏—Å–ª–∞ –≤ IP

–ò—Ç–∞–∫, —É –Ω–∞—Å –µ—Å—Ç—å IP –≤ –≤–∏–¥–µ DEC —á–∏—Å–ª–∞ –∏ –Ω–∞–º –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –∏–∑ –Ω–µ–≥–æ –≥–ª–∞–∑—É –ø–æ–Ω—è—Ç–Ω—ã–π IP. –ê–ª–≥–æ—Ä–∏—Ç–º —á–µ–ª–æ–≤–µ—á–µ—Å–∫–∏–º —è–∑—ã–∫–æ–º:

1. –ü—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ–º DEC –≤ –≤–∏–¥–µ BIN
2. –í—ã—Ä—ã–≤–∞–µ–º —Å —ç—Ç–æ–≥–æ BIN 4 –∫—É—Å–æ—á–∫–∞
3. –†–∞–∑–¥–µ–ª—è–µ–º –∏—Ö —Ç–æ—á–∫–æ–π

Lua —Ñ—É–Ω–∫—Ü–∏—è:

```lua showLineNumbers
-- –ú–∞—Å–∫–∏ –∏–∑ –ø—Ä–∏–º–µ—Ä–∞ –Ω–∏–∂–µ
-- FF 00 00 00 == 11111111 00000000 00000000 00000000
-- 00 FF 00 00 == 00000000 11111111 00000000 00000000
-- 00 00 FF 00 == 00000000 00000000 11111111 00000000
-- 00 00 00 FF == 00000000 00000000 00000000 11111111

local function intToIp(int) -- 635884083 (00100101 11100110 11010010 00110011)
	local a = bit.band(int, 0xFF000000) -- 00100101 00000000 00000000 00000000 | 25 00 00 00 | 037.000.000.000
	local b = bit.band(int, 0x00FF0000) -- 00000000 11100110 00000000 00000000 | 00 E6 00 00 | 000.230.000.000
	local c = bit.band(int, 0x0000FF00) -- 00000000 00000000 11010010 00000000 | 00 00 D2 00 | 000.000.210.000
	local d = bit.band(int, 0x000000FF) -- 00000000 00000000 00000000 00110011 | 00 00 00 33 | 000.000.000.051

	a = bit.rshift(a, 24) -- –ø–æ–º–µ—â–∞–µ–º –≤ —Å–∞–º–æ–µ –Ω–∞—á–∞–ª–æ
	b = bit.rshift(b, 16) -- –Ω–∞ –≤—Ç–æ—Ä–æ–µ –º–µ—Å—Ç–æ
	c = bit.rshift(c, 8) -- –Ω–∞ —Ç—Ä–µ—Ç—å–µ
	-- —á–µ—Ç–≤–µ—Ä—Ç–æ–µ —É–∂–µ –Ω–∞ —Å–≤–æ–µ–º

	local ip = a .. "." .. b .. "." .. c .. "." .. d
	return ip -- 37.230.210.51
end

print( intToIp(635884083) )
```

–§—É–Ω–∫—Ü–∏—è bit.band(a, b) –∑–∞–º–µ–Ω—è–µ—Ç –ø–æ–±–∏—Ç–æ–≤—ã–π –æ–ø–µ—Ä–∞—Ç–æ—Ä **AND** (–∏). –û–Ω –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —á–∏—Å–ª–æ, –≤ –∫–æ—Ç–æ—Ä–æ–º —Ç–æ–ª—å–∫–æ —Ç–µ –±–∏—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –∏ –≤ `a`, –∏ –≤ `b`. –¢–æ–µ—Å—Ç—å `bit.band(0x00FF, 0xFF00)` –≤–µ—Ä–Ω–µ—Ç 0xFFFF. –≠—Ç–æ —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω–æ `bit.band(0000000011111111, 1111111100000000) == 1111111111111111`.

rshift —ç—Ç–æ –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω–æ—Å—Ç—å lshift, –æ –∫–æ—Ç–æ—Ä–æ–º —è –ø–∏—Å–∞–ª –≤—ã—à–µ

## –ë–æ–Ω—É—Å

–Ø –Ω–∞—á–∞–ª –∏–∑—É—á–µ–Ω–∏–µ —ç—Ç–æ–≥–æ –≤–æ–ø—Ä–æ—Å–∞ —Å —Ñ—É–Ω–∫—Ü–∏–∏, –≥–æ–≤–æ—Ä—è—â–µ–π, –≤—Ö–æ–¥–∏—Ç –ª–∏ IP –≤ –º–∞—Å–∫—É, –ø–æ—ç—Ç–æ–º—É –¥–µ–ª—é—Å—å –∏ –µ—é:
 ![lua-function-mask-has-ip](https://s3.amd-nick.me/2018/07/lua-function-mask-has-ip.png)

## –°—Å—ã–ª–∫–∏

- [HEX to DEC converter](https://www.binaryhexconverter.com/hex-to-decimal-converter)
- [DEC to BIN and HEX converter](https://www.rapidtables.com/convert/number/decimal-to-binary.html)
- [–í–∏–∑—É–∞–ª—å–Ω–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –º–∞—Å–æ–∫ —Å–µ—Ç–∏](http://www.aboutmyip.com/AboutMyXApp/SubnetCalculator.jsp)
- [–ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä IP –≤ —á–∏—Å–ª–æ –∏ BIN –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ](http://www.aboutmyip.com/AboutMyXApp/IP2Integer.jsp)
- [–ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä —á–∏—Å–ª–∞ –≤ IP](https://ipduh.com/ip/fromint/)

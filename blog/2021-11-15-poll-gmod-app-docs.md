---
layout: post
title: poll.gmod.app –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
date: '2021-11-15 10:37:00'
tags:
- programming
---

–≠—Ç–æ –ø—Ä–æ—Å—Ç–µ–π—à–∏–π [Long Polling](https://learn.javascript.ru/long-polling) –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å, –∫–æ—Ç–æ—Ä—ã–π –≤—ã—Å—Ç—É–ø–∞–µ—Ç –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Å–≤–æ–µ–æ–±—Ä–∞–∑–Ω–æ–≥–æ WebHook —Å–µ—Ä–≤–µ—Ä–∞ –¥–ª—è POST –∑–∞–ø—Ä–æ—Å–æ–≤. –ü—Ä–∏–Ω—è—Ç—ã–µ –¥–∞–Ω–Ω—ã–µ –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å —Å —Å–µ—Ä–≤–µ—Ä–∞ –ø–æ GET –∑–∞–ø—Ä–æ—Å—É.

> –†–∞—Å—Å—á–∏—Ç–∞–Ω –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–π —Å—Ä–µ–¥—ã, –≥–¥–µ —É—Å–ª–æ–∂–Ω–µ–Ω–∞ –∏–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–æ–¥–Ω—è—Ç–∏—è Web —Å–µ—Ä–≤–µ—Ä–∞ –¥–ª—è —Å–≤–æ–∏—Ö –≤–µ–±—Ö—É–∫–æ–≤.

–†–µ–∫–æ–º–µ–Ω–¥—É—é –ø—Ä–æ—á–µ—Å—Ç—å [—ç—Ç–æ](https://learn.javascript.ru/long-polling), –µ—Å–ª–∏ –≤—ã –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç–µ LongPolling –∫–∞–∫ GET –∑–∞–ø—Ä–æ—Å —Ä–∞–∑ –≤ 10 —Å–µ–∫—É–Ω–¥.

<figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://s3.blog.amd-nick.me/2021/11/image-3.png" class="kg-image" alt loading="lazy" width="1262" height="582"><figcaption>–û–¥–Ω–æ–π —ç—Ç–æ–π —Å—Ö–µ–º—ã –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ, —á—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å –∫–∞–∫ –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ Telegram –±–æ—Ç–∞</figcaption></img></figure>

–í –Ω–µ–¥–∞–≤–Ω–µ–º –ø–æ—Å—Ç–µ —Ä–∞—Å—Å–∫–∞–∑–∞–Ω—ã –≤–∞—Ä–∏–∞–Ω—Ç—ã –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —ç—Ç–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞. –†–µ–∫–æ–º–µ–Ω–¥—É—é –ø–æ—á–∏—Ç–∞—Ç—å:

<figure class="kg-card kg-bookmark-card"><a class="kg-bookmark-container" href=" __GHOST_URL__ /webhook-bez-web-servera/"><div class="kg-bookmark-content">
<div class="kg-bookmark-title">Webhook –±–µ–∑ –≤–µ–± —Å–µ—Ä–≤–µ—Ä–∞</div>
<div class="kg-bookmark-description">–ï—Å–ª–∏ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –≤–µ–± —Å–µ—Ä–≤–µ—Ä —Å –≤–µ–±—Ö—É–∫–æ–º –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –Ω–µ—Ç, –∞ –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –∫–∞–∫–æ–≥–æ-—Ç–æ —Å–µ—Ä–≤–∏—Å–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä Telegram) –Ω—É–∂–Ω–æ, –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º polling. –≠—Ç–æ –∫–æ–≥–¥–∞ –º—ã —Å–∞–º–∏ —Å–ø—Ä–∞—à–∏–≤–∞–µ–º —É —Å–µ—Ä–≤–∏—Å–∞, –Ω–µ—Ç –ª–∏ —É –Ω–µ–≥–æ –¥–ª—è –Ω–∞—Å –Ω–æ–≤–æ—Å—Ç–µ–π. –í —Å–ª—É—á–∞–µ —Å Telegram, —ç—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ –∑–∞–ø—Ä–æ—Å getUpdates. –ù–æ —á—Ç–æ, –µ—Å–ª–∏ —Å–µ—Ä–≤–∏—Å‚Ä¶</div>
<div class="kg-bookmark-metadata">
<span class="kg-bookmark-author">–ë–ª–æ–≥ _AMD_</span><span class="kg-bookmark-publisher">_AMD_</span>
</div>
</div>
<div class="kg-bookmark-thumbnail"><img src="https://s3.blog.amd-nick.me/2021/03/long-polling-instead-webhook.jpg" alt=""></img></div></a></figure>
# API

–ú—ã —Ö–æ—Ç–µ–ª–∏ —Å–¥–µ–ª–∞—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø—Ä–æ—Å—Ç–æ–π API, –ø–æ—ç—Ç–æ–º—É –Ω–µ—Ç –Ω–∏–∫–∞–∫–∏—Ö —Ç–æ–∫–µ–Ω–æ–≤, –ø–∞—Ä–æ–ª–µ–π, —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–π. –í—Å–µ –¥–∞–Ω–Ω—ã–µ —Å—á–∏—Ç–∞—é—Ç—Å—è –ø—É–±–ª–∏—á–Ω—ã–º–∏ (–ª—é–±–æ–π –º–æ–∂–µ—Ç –ø—Ä–æ—á–µ—Å—Ç—å –∏–ª–∏ –∑–∞–ø–∏—Å–∞—Ç—å), –Ω–æ –≤—ã –º–æ–∂–µ—Ç–µ —Å–ø—Ä—è—Ç–∞—Ç—å –∏—Ö, –ø–æ–¥—Å—Ç–∞–≤–∏–≤ –≤–º–µ—Å—Ç–æ SECRET\_UID —á—Ç–æ-—Ç–æ –≤—Ä–æ–¥–µ –ø–∞—Ä–æ–ª—è –∏–ª–∏ —Ç–æ–∫–µ–Ω–∞.

- GET https://poll.gmod.app/SECRET\_UID/getUpdates
- POST https://poll.gmod.app/SECRET\_UID/pushUpdates

–ë–æ–ª—å—à–µ –Ω–∏—á–µ–≥–æ. –ü–æ—á—Ç–∏. –£ GET –∑–∞–ø—Ä–æ—Å–∞ –µ—Å—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —É–∫–∞–∑–∞–Ω–∏—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, –Ω–æ —Å–Ω–∞—á–∞–ª–∞ –ø–æ–∫–∞–∂—É –ø—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞ –æ—Ç GET –∑–∞–ø—Ä–æ—Å–∞

<figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://s3.blog.amd-nick.me/2021/11/image-2.png" class="kg-image" alt loading="lazy" width="694" height="136"><figcaption>–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –º–∞—Å—Å–∏–≤ —Å –ø–æ–ª—è–º–∏ ok, ts –∏ updates. –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ ts, –æ–Ω –ø—Ä–∏–≥–æ–¥–∏—Ç—Å—è –¥–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è GET –∑–∞–ø—Ä–æ—Å–∞</figcaption></img></figure>
- **?ts=12345**. –≠—Ç–æ offset. –ï–≥–æ –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–ª—è—Ç—å –∫–∞–∂–¥—ã–π —Ä–∞–∑, –∫–æ–≥–¥–∞ –≤—ã –ø–æ–ª—É—á–∞–µ—Ç–µ –Ω–æ–≤—ã–π –∞–ø–¥–µ–π—Ç. –ë–µ–∑ —ç—Ç–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –∫–∞–∂–¥—ã–π —Ä–∞–∑ –±—É–¥—É—Ç –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å—Å—è –≤—Å–µ –ø–æ—Å–ª–µ–¥–Ω–∏–µ –∞–ø–¥–µ–π—Ç—ã, –∞ —Å–ª–µ–¥—É—é—â–∏–π –ø–∞—Ä–∞–º–µ—Ç—Ä sleep –Ω–µ –±—É–¥–µ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å—Å—è, –ø–æ—Ç–æ–º—É —á—Ç–æ —Å–µ—Ä–≤–µ—Ä —Ä–µ—à–∏—Ç, —á—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤–∞–º —á—Ç–æ-—Ç–æ –Ω–æ–≤–æ–µ
- **?sleep=60** , default 0, max 60. –í—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ. –≠—Ç–æ –≤—Ä–µ–º—è poll.gmod.app –±—É–¥–µ—Ç –∫–∞–∫ –±—ã "–≤–∏—Å–µ—Ç—å". –ù–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –æ–Ω –±—É–¥–µ—Ç —É–¥–µ—Ä–∂–∏–≤–∞—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ, –ø–æ–∫–∞ –Ω–µ –ø–æ—è–≤—è—Ç—Å—è –Ω–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–ª–∏ –Ω–µ –∏—Å—Ç–µ—á–µ—Ç —É–∫–∞–∑–∞–Ω–Ω—ã–π —Å—Ä–æ–∫. –ë–µ–∑ —É–∫–∞–∑–∞–Ω–∏—è sleep —Å–º—ã—Å–ª–∞ —Å Long Polling –º–∞–ª–æ, –≤–µ–¥—å —Å—É—Ç—å –∫–∞–∫ —Ä–∞–∑ –≤ —É–¥–µ—Ä–∂–∞–Ω–∏–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –¥–æ –ø–æ—è–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö. –ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ —Å–±—Ä–æ—Å–∞ –ø–æ —Ç–∞–π–º–∞—É—Ç—É –º–æ–∂–Ω–æ —Å–º–µ–ª–æ –∑–∞–Ω–æ–≤–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å GET –∑–∞–ø—Ä–æ—Å. sleep=60 –æ–∑–Ω–∞—á–∞–µ—Ç 1 GET –∑–∞–ø—Ä–æ—Å –≤ –º–∏–Ω—É—Ç—É.

## –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–∞–∫–æ–π —Å–µ—Ä–≤–∏—Å –ø—Ä–∏—Å–ª–∞–ª –∞–ø–¥–µ–π—Ç

POST –∑–∞–ø—Ä–æ—Å –º–æ–∂–µ—Ç –ø—Ä–∏–Ω—è—Ç—å –ª—é–±—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã. –û–Ω–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ –∫–∞–∂–¥—ã–π update –æ–±—ä–µ–∫—Ç, —á—Ç–æ –ø–æ–ª–µ–∑–Ω–æ –¥–ª—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å–µ—Ä–≤–∏—Å–∞, —Å –∫–æ—Ç–æ—Ä–æ–≥–æ –ø—Ä–∏—à–µ–ª –∞–ø–¥–µ–π—Ç, –µ—Å–ª–∏ –≤—ã —É–∫–∞–∑—ã–≤–∞–µ—Ç–µ –æ–¥–∏–Ω webhook –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–µ—Ä–≤–∏—Å–∞—Ö. –ù–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–∞–∫–æ–π —Ç–µ–ª–µ–≥—Ä–∞–º –±–æ—Ç –ø—Ä–∏—Å–ª–∞–ª –∞–ø–¥–µ–π—Ç, —è –∑–∞–¥–∞—é –∫–∞–∂–¥–æ–º—É –±–æ—Ç—É –≤–µ–±—Ö—É–∫ –≤ —Ç–∞–∫–æ–º —Å—Ç–∏–ª–µ: /setWebhook?url=https://poll.gmod.app/myS3cretU1D/pushUpdates?botname=video\_thumbnails\_bot.

–¢–µ–ø–µ—Ä—å –Ω–∞ GET https://poll.gmod.app/myS3cretU1D/getUpdates –≤ –∫–∞–∂–¥–æ–º –∞–ø–¥–µ–π—Ç–µ –±—É–¥–µ—Ç –ø–æ–ª–µ botname=video\_thumbnails\_bot

## –ü—Ä–∏–º–µ—Ä –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –Ω–∞ Lua –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å poll.gmod.app
<figure class="kg-card kg-bookmark-card"><a class="kg-bookmark-container" href="https://github.com/GM-DONATE/IGS/blob/main/addons/igs-core/lua/igs/modules/pushes/akupol_sv.lua"><div class="kg-bookmark-content">
<div class="kg-bookmark-title">IGS/akupol_sv.lua at main ¬∑ GM-DONATE/IGS</div>
<div class="kg-bookmark-description">üõç –í–Ω—É—Ç—Ä–∏–∏–≥—Ä–æ–≤–æ–π –º–∞–≥–∞–∑–∏–Ω –¥–ª—è Garry‚Äôs Mod https://git.io/IGS - IGS/akupol_sv.lua at main ¬∑ GM-DONATE/IGS</div>
<div class="kg-bookmark-metadata">
<img class="kg-bookmark-icon" src="https://github.com/fluidicon.png" alt=""><span class="kg-bookmark-author">GitHub</span><span class="kg-bookmark-publisher">GM-DONATE</span></img>
</div>
</div>
<div class="kg-bookmark-thumbnail"><img src="https://opengraph.githubassets.com/50151420544baf6e3cec164638c8a9dea5d33bfeda6d3a439f64c3050ac00dc5/GM-DONATE/IGS" alt=""></img></div></a></figure>

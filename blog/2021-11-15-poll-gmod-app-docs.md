---
title: poll.gmod.app –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
date: '2021-11-15 13:37:00'
slug: poll-gmod-app-docs
image: https://s3.amd-nick.me/2021/11/poll-gmod-app-docs.jpg
tags: [polling, lua, microservice, api]
---

![](https://s3.amd-nick.me/2021/11/poll-gmod-app-docs.jpg)

:::warning üÜò UPD 2023.12.15

–≠—Ç–æ—Ç –ø–æ—Å—Ç –Ω–µ–º–Ω–æ–≥–æ —É—Å—Ç–∞—Ä–µ–ª, **–Ω–æ** –æ–Ω —É–∂–µ –ø–µ—Ä–µ–ø–∏—Å–∞–Ω –∏ –∞–∫—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω [—Ç—É—Ç](./2023/12-15-long-polling/index.md) üëà
–†–µ–∫–æ–º–µ–Ω–¥—É—é —Å—Ä–∞–∑—É —á–∏—Ç–∞—Ç—å —Å—Ç–∞—Ç—å—é –ø–æ —Å—Å—ã–ª–∫–µ

- –í—Å–µ —É–ø–æ–º–∏–Ω–∞–Ω–∏—è `poll.gmod.app` –≤ —ç—Ç–æ–º –ø–æ—Å—Ç–µ –∑–∞–º–µ–Ω–µ–Ω—ã –Ω–∞ `poll.def.pm` (–Ω–æ –æ–±–∞ –¥–æ–º–µ–Ω–∞ —Ä–∞–±–æ—á–∏–µ –≤ –¥–µ–º–æ —Ä–µ–∂–∏–º–µ)

:::

–≠—Ç–æ –ø—Ä–æ—Å—Ç–µ–π—à–∏–π [Long Polling](https://learn.javascript.ru/long-polling) –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å, –∫–æ—Ç–æ—Ä—ã–π –≤—ã—Å—Ç—É–ø–∞–µ—Ç –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Å–≤–æ–µ–æ–±—Ä–∞–∑–Ω–æ–≥–æ WebHook —Å–µ—Ä–≤–µ—Ä–∞ –¥–ª—è POST –∑–∞–ø—Ä–æ—Å–æ–≤. –ü—Ä–∏–Ω—è—Ç—ã–µ –¥–∞–Ω–Ω—ã–µ –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å —Å —Å–µ—Ä–≤–µ—Ä–∞ –ø–æ GET –∑–∞–ø—Ä–æ—Å—É.

<!--truncate-->

> –†–∞—Å—Å—á–∏—Ç–∞–Ω –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–π —Å—Ä–µ–¥—ã, –≥–¥–µ —É—Å–ª–æ–∂–Ω–µ–Ω–∞ –∏–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–æ–¥–Ω—è—Ç–∏—è Web —Å–µ—Ä–≤–µ—Ä–∞ –¥–ª—è —Å–≤–æ–∏—Ö –≤–µ–±—Ö—É–∫–æ–≤.

–†–µ–∫–æ–º–µ–Ω–¥—É—é –ø—Ä–æ—á–µ—Å—Ç—å [—ç—Ç–æ](https://learn.javascript.ru/long-polling), –µ—Å–ª–∏ –≤—ã –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç–µ LongPolling –∫–∞–∫ GET –∑–∞–ø—Ä–æ—Å —Ä–∞–∑ –≤ 10 —Å–µ–∫—É–Ω–¥ (—ç—Ç–æ –Ω–µ —Ç–∞–∫).

![](https://s3.amd-nick.me/2021/11/image-3.png)
*–û–¥–Ω–æ–π —ç—Ç–æ–π —Å—Ö–µ–º—ã –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ, —á—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å –∫–∞–∫ –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ Telegram –±–æ—Ç–∞*

–í –Ω–µ–¥–∞–≤–Ω–µ–º –ø–æ—Å—Ç–µ —Ä–∞—Å—Å–∫–∞–∑–∞–Ω—ã –≤–∞—Ä–∏–∞–Ω—Ç—ã –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —ç—Ç–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞. –†–µ–∫–æ–º–µ–Ω–¥—É—é –ø–æ—á–∏—Ç–∞—Ç—å: [Webhook –±–µ–∑ –≤–µ–± —Å–µ—Ä–≤–µ—Ä–∞](2021-03-08-webhook-bez-web-servera.md)

## API

–ú—ã —Ö–æ—Ç–µ–ª–∏ —Å–¥–µ–ª–∞—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø—Ä–æ—Å—Ç–æ–π API, –ø–æ—ç—Ç–æ–º—É –Ω–µ—Ç –Ω–∏–∫–∞–∫–∏—Ö —Ç–æ–∫–µ–Ω–æ–≤, –ø–∞—Ä–æ–ª–µ–π, —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–π. –í—Å–µ –¥–∞–Ω–Ω—ã–µ —Å—á–∏—Ç–∞—é—Ç—Å—è –ø—É–±–ª–∏—á–Ω—ã–º–∏ (–ª—é–±–æ–π –º–æ–∂–µ—Ç –ø—Ä–æ—á–µ—Å—Ç—å –∏–ª–∏ –∑–∞–ø–∏—Å–∞—Ç—å), –Ω–æ –≤—ã –º–æ–∂–µ—Ç–µ —Å–ø—Ä—è—Ç–∞—Ç—å –∏—Ö, –ø–æ–¥—Å—Ç–∞–≤–∏–≤ –≤–º–µ—Å—Ç–æ SECRET\_UID —á—Ç–æ-—Ç–æ –≤—Ä–æ–¥–µ –ø–∞—Ä–æ–ª—è –∏–ª–∏ —Ç–æ–∫–µ–Ω–∞.

- GET https://poll.def.pm/SECRET_UID
- POST https://poll.def.pm/SECRET_UID

–ë–æ–ª—å—à–µ –Ω–∏—á–µ–≥–æ. –ü–æ—á—Ç–∏. –£ GET –∑–∞–ø—Ä–æ—Å–∞ –µ—Å—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —É–∫–∞–∑–∞–Ω–∏—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, –Ω–æ —Å–Ω–∞—á–∞–ª–∞ –ø–æ–∫–∞–∂—É –ø—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞ –æ—Ç GET –∑–∞–ø—Ä–æ—Å–∞

![](https://s3.amd-nick.me/2021/11/image-2.png)
*–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –º–∞—Å—Å–∏–≤ —Å –ø–æ–ª—è–º–∏ ok, ts –∏ updates. –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ ts, –æ–Ω –ø—Ä–∏–≥–æ–¥–∏—Ç—Å—è –¥–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è GET –∑–∞–ø—Ä–æ—Å–∞*

- **?ts=12345**. –≠—Ç–æ offset. –ï–≥–æ –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–ª—è—Ç—å –∫–∞–∂–¥—ã–π —Ä–∞–∑, –∫–æ–≥–¥–∞ –≤—ã –ø–æ–ª—É—á–∞–µ—Ç–µ –Ω–æ–≤—ã–π –∞–ø–¥–µ–π—Ç. –ë–µ–∑ —ç—Ç–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –∫–∞–∂–¥—ã–π —Ä–∞–∑ –±—É–¥—É—Ç –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å—Å—è –≤—Å–µ –ø–æ—Å–ª–µ–¥–Ω–∏–µ –∞–ø–¥–µ–π—Ç—ã, –∞ —Å–ª–µ–¥—É—é—â–∏–π –ø–∞—Ä–∞–º–µ—Ç—Ä sleep –Ω–µ –±—É–¥–µ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å—Å—è, –ø–æ—Ç–æ–º—É —á—Ç–æ —Å–µ—Ä–≤–µ—Ä —Ä–µ—à–∏—Ç, —á—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤–∞–º —á—Ç–æ-—Ç–æ –Ω–æ–≤–æ–µ
- **?sleep=60** , default 0, max 60. –í—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ. –≠—Ç–æ –≤—Ä–µ–º—è poll.def.pm –±—É–¥–µ—Ç –∫–∞–∫ –±—ã "–≤–∏—Å–µ—Ç—å". –ù–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –æ–Ω –±—É–¥–µ—Ç —É–¥–µ—Ä–∂–∏–≤–∞—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ, –ø–æ–∫–∞ –Ω–µ –ø–æ—è–≤—è—Ç—Å—è –Ω–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–ª–∏ –Ω–µ –∏—Å—Ç–µ—á–µ—Ç —É–∫–∞–∑–∞–Ω–Ω—ã–π —Å—Ä–æ–∫. –ë–µ–∑ —É–∫–∞–∑–∞–Ω–∏—è sleep —Å–º—ã—Å–ª–∞ —Å Long Polling –º–∞–ª–æ, –≤–µ–¥—å —Å—É—Ç—å –∫–∞–∫ —Ä–∞–∑ –≤ —É–¥–µ—Ä–∂–∞–Ω–∏–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –¥–æ –ø–æ—è–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö. –ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ —Å–±—Ä–æ—Å–∞ –ø–æ —Ç–∞–π–º–∞—É—Ç—É –º–æ–∂–Ω–æ —Å–º–µ–ª–æ –∑–∞–Ω–æ–≤–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å GET –∑–∞–ø—Ä–æ—Å. sleep=60 –æ–∑–Ω–∞—á–∞–µ—Ç 1 GET –∑–∞–ø—Ä–æ—Å –≤ –º–∏–Ω—É—Ç—É.

### –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–∞–∫–æ–π —Å–µ—Ä–≤–∏—Å –ø—Ä–∏—Å–ª–∞–ª –∞–ø–¥–µ–π—Ç

POST –∑–∞–ø—Ä–æ—Å –º–æ–∂–µ—Ç –ø—Ä–∏–Ω—è—Ç—å –ª—é–±—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã. –û–Ω–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ –∫–∞–∂–¥—ã–π update –æ–±—ä–µ–∫—Ç, —á—Ç–æ –ø–æ–ª–µ–∑–Ω–æ –¥–ª—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å–µ—Ä–≤–∏—Å–∞, —Å –∫–æ—Ç–æ—Ä–æ–≥–æ –ø—Ä–∏—à–µ–ª –∞–ø–¥–µ–π—Ç, –µ—Å–ª–∏ –≤—ã —É–∫–∞–∑—ã–≤–∞–µ—Ç–µ –æ–¥–∏–Ω webhook –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–µ—Ä–≤–∏—Å–∞—Ö. –ù–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–∞–∫–æ–π —Ç–µ–ª–µ–≥—Ä–∞–º –±–æ—Ç –ø—Ä–∏—Å–ª–∞–ª –∞–ø–¥–µ–π—Ç, —è –∑–∞–¥–∞—é –∫–∞–∂–¥–æ–º—É –±–æ—Ç—É –≤–µ–±—Ö—É–∫ –≤ —Ç–∞–∫–æ–º —Å—Ç–∏–ª–µ: `/setWebhook?url=https://poll.def.pm/myS3cretU1D?botname=video_thumbnails_bot`.

–¢–µ–ø–µ—Ä—å –Ω–∞ GET https://poll.def.pm/myS3cretU1D –≤ –∫–∞–∂–¥–æ–º —Ç–∞–∫–æ–º –∞–ø–¥–µ–π—Ç–µ –±—É–¥–µ—Ç –ø–æ–ª–µ botname=video\_thumbnails\_bot

## –ü—Ä–∏–º–µ—Ä –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –Ω–∞ Lua –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å poll.def.pm

[IGS/akupol_sv.lua at main ¬∑ GM-DONATE/IGS](https://github.com/GM-DONATE/IGS/blob/main/addons/igs-core/lua/igs/modules/pushes/akupol_sv.lua)
